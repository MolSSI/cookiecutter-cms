language: python

matrix:
  include:

    # Extra includes for OSX since python language is not available by default on OSX
    - os: osx
      language: generic
      env:
        - LICENSE=1
        - DEPEND_SOURCE=1
        - PYTHON_VER=3.7
        - CI_PROVIDER=2  # Travis+Appveyor
        - RTD=2
    - os: osx
      language: generic
      env:
        - LICENSE=1
        - DEPEND_SOURCE=2
        - PYTHON_VER=3.7
        - CI_PROVIDER=2
        - RTD=1
    - os: osx
      language: generic
      env:
        - LICENSE=2
        - DEPEND_SOURCE=3
        - PYTHON_VER=3.7
        - CI_PROVIDER=2
        - RTD=1
    - os: osx
      language: generic
      env:
        - LICENSE=2
        - DEPEND_SOURCE=3
        - PYTHON_VER=3.7
        - CI_PROVIDER=1  # Travis only
        - RTD=1
    - os: osx
      language: generic
      env:
        - LICENSE=1
        - DEPEND_SOURCE=1
        - PYTHON_VER=3.6
        - CI_PROVIDER=2
        - RTD=1
    - os: osx
      language: generic
      env:
        - LICENSE=1
        - DEPEND_SOURCE=2
        - PYTHON_VER=3.6
        - CI_PROVIDER=2
        - RTD=1
    - os: osx
      language: generic
      env:
        - LICENSE=2
        - DEPEND_SOURCE=3
        - PYTHON_VER=3.6
        - CI_PROVIDER=2
        - RTD=1
    - os: osx
      language: generic
      env:
        - LICENSE=2
        - DEPEND_SOURCE=3
        - PYTHON_VER=3.6
        - CI_PROVIDER=1
        - RTD=1

    # Pin Xenial for 3.7
    - os: linux
      dist: xenial
      python: 3.7
      env:
        - LICENSE=1
        - DEPEND_SOURCE=1
        - PYTHON_VER=3.7
        - CI_PROVIDER=2
        - RTD=1

    - os: linux
      dist: xenial
      python: 3.7
      env:
        - LICENSE=1
        - DEPEND_SOURCE=2
        - PYTHON_VER=3.7
        - CI_PROVIDER=2
        - RTD=1

    - os: linux
      dist: xenial
      python: 3.7
      env:
        - LICENSE=2
        - DEPEND_SOURCE=3
        - PYTHON_VER=3.7
        - CI_PROVIDER=2
        - RTD=1

    - os: linux
      dist: xenial
      python: 3.7
      env:
        - LICENSE=2
        - DEPEND_SOURCE=3
        - PYTHON_VER=3.7
        - CI_PROVIDER=1
        - RTD=1

    - os: linux
      python: 3.6
      env:
        - LICENSE=1
        - DEPEND_SOURCE=1
        - PYTHON_VER=3.6
        - CI_PROVIDER=2
        - RTD=1

    - os: linux
      python: 3.6
      env:
        - LICENSE=1
        - DEPEND_SOURCE=2
        - PYTHON_VER=3.6
        - CI_PROVIDER=2
        - RTD=1

    - os: linux
      python: 3.6
      env:
        - LICENSE=2
        - DEPEND_SOURCE=3
        - PYTHON_VER=3.6
        - CI_PROVIDER=2
        - RTD=1

    - os: linux
      python: 3.6
      env:
        - LICENSE=2
        - DEPEND_SOURCE=3
        - PYTHON_VER=3.6
        - CI_PROVIDER=1
        - RTD=1

before_install:
    # Make sure pip is around, on OSX Travis we have to do some shenanigans
  - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then source cihelpers/osx_travis_py_helper.sh; fi

    # Install a few requirements
  - pip install pyyaml cookiecutter

    # Build out the cookiecutter from settings
  - python tests/setup_cookiecutter.py default_project $LICENSE $DEPEND_SOURCE $CI_PROVIDER $RTD

    # Change into new project directory
  - cd default_project

install:
  - python ../tests/run_yaml.py .travis.yml before_install before_install.travis
  - source before_install.travis

  - pip install pyyaml
  - python ../tests/run_yaml.py .travis.yml install install.travis
  - source install.travis

script:
  - pip install pyyaml
  - python ../tests/run_yaml.py .travis.yml script script.travis
  - source script.travis


after_install:

    # Build the docs
  - cd docs
  - make html
